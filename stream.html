<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>M&N Stream</title>
  <script src="https://cdn.tutorialjinni.com/hls.js/1.2.1/hls.min.js"></script>
  <style>
    * { box-sizing: border-box; }
    body { margin:0; font-family:'Segoe UI',sans-serif; display:flex; flex-direction:column; align-items:center; background:#111; color:white; }
    #header { font-size:32px; font-weight:bold; background:rgba(0,0,0,0.7); padding:15px 30px; width:100%; text-align:center; position:fixed; top:0; left:0; z-index:100; backdrop-filter: blur(8px); box-shadow:0 0 10px rgba(255,255,255,0.1); }
    #back-button { position:fixed; top:12px; right:20px; background:#ff4c4c; color:white; border:none; padding:10px 20px; border-radius:6px; cursor:pointer; z-index:101; font-weight:bold; }
    #video-container { margin-top:100px; width:80%; max-width:900px; aspect-ratio:16/9; background:#000; border-radius:15px; box-shadow:0 0 30px rgba(0,255,255,0.2); overflow:hidden; position:relative; }
    video { width:100%; height:100%; object-fit:contain; border-radius:15px; }
    #channel-buttons { margin-top:30px; display:flex; flex-wrap:wrap; justify-content:center; gap:15px; }
    #channel-buttons button { padding:12px 25px; font-size:17px; background:linear-gradient(45deg,#00c3ff,#0047ff); color:white; border:none; border-radius:8px; cursor:pointer; font-weight:bold; box-shadow:0 4px 12px rgba(0,0,0,0.5); transition:all 0.3s ease; }
    #channel-buttons button:hover { transform:scale(1.15); background:linear-gradient(45deg,#ff00e0,#8000ff); box-shadow:0 0 20px #fff; }
    #logo { position:fixed; top:12px; left:20px; width:80px; height:auto; z-index:101; }
  </style>
</head>
<body>
  <!-- Logo -->
  <img src="logo.png" id="logo" alt="Logo">

  <div id="header">
    M&N Stream
    <button id="back-button" onclick="window.location.href='index.html'">Geri Dön</button>
  </div>

  <div id="video-container">
    <video id="video" controls autoplay></video>
  </div>

  <div id="channel-buttons"></div>

  <script>
    // Auth check
    if(localStorage.getItem("auth") !== "ok"){
      alert("Lütfen giriş yapın!");
      window.location.href="index.html";
    }

    let hls;
    const video = document.getElementById('video');
    const btnContainer = document.getElementById('channel-buttons');
    let streams = {};

    // JSON'dan kanalları yükle ve buton oluştur
    fetch('channels.json')
      .then(res => res.json())
      .then(data => {
        data.forEach(c => {
          streams[c.id] = c.url;
          const btn = document.createElement('button');
          btn.textContent = c.name;
          btn.onclick = () => switchStream(c.id);
          btnContainer.appendChild(btn);
        });
        switchStream(data[0].id); // İlk kanalı başlat
      });

    // HLS Switch fonksiyonu
    function switchStream(channel){
      if(!streams[channel]) return;
      if(Hls.isSupported()){
        if(hls) hls.destroy();
        hls = new Hls();
        hls.loadSource(streams[channel]);
        hls.attachMedia(video);
      } else {
        video.src = streams[channel];
      }
      video.play();
    }
  </script>
</body>
</html>
